import React, { useState } from 'react';

const OutcomeMindMap = () => {
  const [selectedBranch, setSelectedBranch] = useState(null);
  const [currentLevel, setCurrentLevel] = useState(2);

  const outcomes = {
    acquisition: {
      name: "Customer Acquisition",
      color: "#FF6B6B",
      icon: "üéØ",
      angle: 0,
      children: {
        "conversion": {
          name: "Increase Conversion",
          level: 2,
          children: {
            "funnel": {
              name: "Optimize Sales Funnel",
              level: 3,
              children: {
                "landing": {
                  name: "Landing Page Optimization",
                  level: 4,
                  children: {
                    "ab_test": "A/B test headlines and CTAs",
                    "personalization": "Dynamic content personalization",
                    "speed": "Reduce page load time to <2 seconds",
                    "social_proof": "Add testimonials and reviews",
                    "mobile": "Mobile conversion optimization"
                  }
                }
              }
            }
          }
        },
        "reach": {
          name: "Expand Market Reach",
          level: 2,
          children: {
            "channels": {
              name: "New Channels",
              level: 3,
              children: {
                "advertising": {
                  name: "Paid Advertising",
                  level: 4,
                  children: {
                    "google": "Google Ads campaigns",
                    "social": "Facebook/Instagram ads",
                    "linkedin": "LinkedIn B2B ads",
                    "retargeting": "Retargeting campaigns",
                    "attribution": "ROI measurement setup"
                  }
                }
              }
            }
          }
        }
      }
    },
    retention: {
      name: "Customer Retention",
      color: "#4ECDC4", 
      icon: "ü§ù",
      angle: 72,
      children: {
        "churn": {
          name: "Reduce Churn",
          level: 2,
          children: {
            "experience": {
              name: "Improve Experience",
              level: 3,
              children: {
                "support": {
                  name: "Customer Support",
                  level: 4,
                  children: {
                    "chat": "24/7 live chat support",
                    "help": "Comprehensive help center",
                    "predictive": "Predictive support recommendations",
                    "onboarding": "Streamlined onboarding process",
                    "feedback": "Real-time feedback systems"
                  }
                }
              }
            }
          }
        }
      }
    },
    revenue: {
      name: "Revenue Diversification",
      color: "#FFD93D",
      icon: "üí∞", 
      angle: 144,
      children: {
        "streams": {
          name: "New Revenue Streams",
          level: 2,
          children: {
            "data": {
              name: "Monetize Data",
              level: 3,
              children: {
                "platform": {
                  name: "Analytics Platform",
                  level: 4,
                  children: {
                    "dashboards": "Customer analytics dashboards",
                    "api": "Data API for enterprise clients",
                    "reports": "Industry insights reports",
                    "benchmarking": "Competitive benchmarking tools",
                    "predictions": "Predictive analytics services"
                  }
                }
              }
            }
          }
        }
      }
    },
    cost: {
      name: "Cost Optimization",
      color: "#6C5CE7",
      icon: "‚ö°",
      angle: 216,
      children: {
        "operational": {
          name: "Reduce Operational Costs",
          level: 2,
          children: {
            "consolidation": {
              name: "Platform Consolidation",
              level: 3,
              children: {
                "audit": {
                  name: "Technology Audit",
                  level: 4,
                  children: {
                    "licenses": "Optimize software licenses",
                    "vendors": "Consolidate vendor relationships",
                    "automation": "Workflow automation implementation",
                    "cloud": "Cloud infrastructure optimization",
                    "contracts": "Vendor contract renegotiation"
                  }
                }
              }
            }
          }
        }
      }
    },
    value: {
      name: "Customer Value Optimization", 
      color: "#00B894",
      icon: "üîß",
      angle: 288,
      children: {
        "personalization": {
          name: "Advanced Personalization",
          level: 2,
          children: {
            "segmentation": {
              name: "Customer Segmentation",
              level: 3,
              children: {
                "analysis": {
                  name: "Behavioral Analysis",
                  level: 4,
                  children: {
                    "clickstream": "Real-time clickstream analysis",
                    "cohorts": "Dynamic cohort analysis dashboards",
                    "clv": "Customer lifetime value prediction",
                    "journey": "Automated customer journey mapping",
                    "sentiment": "Multi-touchpoint sentiment analysis"
                  }
                }
              }
            }
          }
        }
      }
    }
  };

  const renderDetailPanel = () => {
    if (!selectedBranch) return null;

    const branch = outcomes[selectedBranch];
    
    const renderChildren = (children, level) => {
      if (level > 5) return null;
      
      return Object.entries(children).map(([key, value]) => {
        if (typeof value === 'string') {
          return (
            <div key={key} className="ml-8 mb-2 p-3 bg-gray-50 rounded-lg">
              <span className="text-sm text-gray-700">‚Ä¢ {value}</span>
            </div>
          );
        }
        
        return (
          <div key={key} className="mb-3">
            <div 
              className={`p-4 rounded-xl cursor-pointer transition-all border-2 ${
                currentLevel >= value.level 
                  ? 'border-current shadow-md' 
                  : 'border-gray-200 hover:border-gray-300'
              }`}
              style={{ 
                backgroundColor: currentLevel >= value.level ? `${branch.color}15` : '#f8f9fa',
                borderColor: currentLevel >= value.level ? branch.color : undefined
              }}
              onClick={() => setCurrentLevel(Math.max(currentLevel, value.level))}
            >
              <span className="font-semibold text-base">L{value.level}: {value.name}</span>
            </div>
            {currentLevel >= value.level && value.children && (
              <div className="ml-4 mt-3">
                {renderChildren(value.children, level + 1)}
              </div>
            )}
          </div>
        );
      });
    };

    return (
      <div className="bg-white p-8 rounded-2xl shadow-xl w-[500px] max-h-[700px] border">
        <div className="flex items-center mb-6">
          <div 
            className="w-12 h-12 rounded-xl mr-4 flex items-center justify-center text-white text-2xl"
            style={{ backgroundColor: branch.color }}
          >
            {branch.icon}
          </div>
          <h3 className="text-2xl font-bold text-gray-800">{branch.name}</h3>
        </div>
        
        <div className="mb-6">
          <div className="flex gap-2">
            {[1, 2, 3, 4, 5].map(level => (
              <button
                key={level}
                onClick={() => setCurrentLevel(level)}
                className={`px-4 py-2 rounded-lg font-medium transition-all ${
                  currentLevel >= level 
                    ? 'text-white shadow-lg' 
                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                }`}
                style={{ 
                  backgroundColor: currentLevel >= level ? branch.color : undefined 
                }}
              >
                Level {level}
              </button>
            ))}
          </div>
        </div>

        <div className="overflow-y-auto max-h-96">
          {renderChildren(branch.children, 2)}
        </div>

        <button 
          onClick={() => setSelectedBranch(null)}
          className="mt-6 px-6 py-3 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-all"
        >
          ‚Üê Back to Mind Map
        </button>
      </div>
    )}
  </>;

  const centerX = 300;
  const centerY = 225;
  const radius = 120;

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-100 to-slate-200 p-8 flex items-center justify-center">
      <div className="flex gap-8">
        
        {/* Mind Map Visualization */}
        <div className="relative">
          <svg width="600" height="450" className="drop-shadow-xl">
            
            {/* Central hub */}
            <circle 
              cx={centerX} 
              cy={centerY} 
              r="60" 
              fill="#2D3748" 
              stroke="#fff" 
              strokeWidth="4"
            />
            <text x={centerX} y={centerY-10} textAnchor="middle" className="text-white text-sm font-bold">
              Strategic
            </text>
            <text x={centerX} y={centerY+5} textAnchor="middle" className="text-white text-sm font-bold">
              Business
            </text>
            <text x={centerX} y={centerY+20} textAnchor="middle" className="text-white text-sm font-bold">
              Outcomes
            </text>

            {/* Connection lines and branch nodes */}
            {Object.entries(outcomes).map(([key, outcome], index) => {
              const angle = (outcome.angle * Math.PI) / 180;
              const x = centerX + radius * Math.cos(angle);
              const y = centerY + radius * Math.sin(angle);
              
              return (
                <g key={key}>
                  {/* Connection line */}
                  <line 
                    x1={centerX} 
                    y1={centerY} 
                    x2={x} 
                    y2={y} 
                    stroke={outcome.color}
                    strokeWidth="4"
                    opacity="0.8"
                  />
                  
                  {/* Branch node */}
                  <circle 
                    cx={x} 
                    cy={y} 
                    r="40" 
                    fill={outcome.color}
                    stroke="#fff" 
                    strokeWidth="3"
                    className="cursor-pointer hover:scale-110 transition-transform duration-200"
                    onClick={() => setSelectedBranch(key)}
                  />
                  
                  {/* Icon */}
                  <text x={x} y={y-5} textAnchor="middle" className="text-white text-xl">
                    {outcome.icon}
                  </text>
                  
                  {/* Label */}
                  <text 
                    x={x} 
                    y={y + (outcome.angle > 90 && outcome.angle < 270 ? -55 : 55)} 
                    textAnchor="middle" 
                    className="text-sm font-bold fill-gray-800"
                  >
                    {outcome.name}
                  </text>
                </g>
              );
            })}
          </svg>
        </div>

        {/* Detail Panel */}
        {selectedBranch && renderDetailPanel()}
        
      </div>

      {/* Instructions */}
      {!selectedBranch && (
        <div className="absolute bottom-8 left-8 bg-white p-6 rounded-xl shadow-lg max-w-sm">
          <h4 className="font-bold mb-3">üó∫Ô∏è Mind Map Navigation</h4>
          <ul className="text-sm text-gray-600 space-y-2">
            <li>‚Ä¢ Central hub connects all strategic outcomes</li>
            <li>‚Ä¢ Click any colored node to explore that branch</li>
            <li>‚Ä¢ Use level buttons to control detail depth</li>
            <li>‚Ä¢ Each branch contains 5 levels of detail</li>
          </ul>
        </div>
      )}
    </div>
  );
};

export default OutcomeMindMap;
